/tmp/llvm-90-install_O_D_A/bin/clang -O3 -fdeclspec -w -Wfatal-errors -fPIC -shared -w -pipe /tmp/*.c -include-pch /tmp/*.h.gch -S -emit-llvm

ruby --disable-gems --jit --jit-save-temps --jit-verbose=2 --jit-wait -e "def branch; if ARGV[-1] == 'some fuckin string'; 1/0;else; 1/2;end ;end;50000.times { branch }"

llvm-link *.ll /home/klee/ruby/vm.bc /home/klee/ruby/object.bc /home/klee/ruby/error.bc /home/klee/ruby/proc.bc /home/klee/ruby/ractor.bc /home/klee/ruby/numeric.bc /home/klee/ruby/string.bc /home/klee/ruby/eval.bc /home/klee/ruby/re.bc /home/klee/ruby/array.bc /home/klee/ruby/hash.bc /home/klee/ruby/mjit*.bc /home/klee/ruby/enumerator.bc /home/klee/ruby/rational.bc /home/klee/ruby/transcode.bc /home/klee/ruby/encoding.bc /home/klee/ruby/io.bc /home/klee/ruby/compar.bc /home/klee/ruby/math.bc /home/klee/ruby/regparse.bc /home/klee/ruby/regcomp.bc /home/klee/ruby/ascii.bc /home/klee/ruby/enum.bc /home/klee/ruby/range.bc /home/klee/ruby/utf_8.bc /home/klee/ruby/us_ascii.bc /home/klee/ruby/file.bc /home/klee/ruby/time.bc -o out.bc

llvm-link *.ll  ~/klee_build/runtime/klee-libc/*64_Release\+Debug\+Asserts*.bc /home/klee/ruby/vm.bc /home/klee/ruby/object.bc /home/klee/ruby/error.bc /home/klee/ruby/proc.bc /home/klee/ruby/ractor.bc /home/klee/ruby/numeric.bc /home/klee/ruby/string.bc /home/klee/ruby/eval.bc /home/klee/ruby/re.bc /home/klee/ruby/array.bc /home/klee/ruby/hash.bc /home/klee/ruby/mjit*.bc /home/klee/ruby/enumerator.bc /home/klee/ruby/rational.bc /home/klee/ruby/transcode.bc /home/klee/ruby/encoding.bc /home/klee/ruby/io.bc /home/klee/ruby/compar.bc /home/klee/ruby/math.bc /home/klee/ruby/regparse.bc /home/klee/ruby/regcomp.bc /home/klee/ruby/ascii.bc /home/klee/ruby/enum.bc /home/klee/ruby/range.bc /home/klee/ruby/utf_8.bc /home/klee/ruby/us_ascii.bc /home/klee/ruby/file.bc /home/klee/ruby/time.bc /home/klee/ruby/main.bc /home/klee/ruby/ruby.bc /home/klee/ruby/process.bc /home/klee/ruby/iseq.bc /home/klee/ruby/signal.bc /home/klee/ruby/gc.bc /home/klee/ruby/symbol.bc /home/klee/ruby/parse.bc -o out.bc

llvm-link *.ll  ~/klee_build/runtime/klee-libc/*64_Release\+Debug\+Asserts*.bc /home/klee/ruby/vm.bc /home/klee/ruby/object.bc /home/klee/ruby/error.bc /home/klee/ruby/proc.bc /home/klee/ruby/ractor.bc /home/klee/ruby/numeric.bc /home/klee/ruby/string.bc /home/klee/ruby/eval.bc /home/klee/ruby/re.bc /home/klee/ruby/array.bc /home/klee/ruby/hash.bc /home/klee/ruby/mjit*.bc /home/klee/ruby/enumerator.bc /home/klee/ruby/rational.bc /home/klee/ruby/transcode.bc /home/klee/ruby/encoding.bc /home/klee/ruby/io.bc /home/klee/ruby/compar.bc /home/klee/ruby/math.bc /home/klee/ruby/regparse.bc /home/klee/ruby/regcomp.bc /home/klee/ruby/ascii.bc /home/klee/ruby/enum.bc /home/klee/ruby/range.bc /home/klee/ruby/utf_8.bc /home/klee/ruby/us_ascii.bc /home/klee/ruby/file.bc /home/klee/ruby/time.bc /home/klee/ruby/main.bc /home/klee/ruby/ruby.bc /home/klee/ruby/process.bc /home/klee/ruby/iseq.bc /home/klee/ruby/signal.bc /home/klee/ruby/gc.bc /home/klee/ruby/symbol.bc /home/klee/ruby/parse.bc /home/klee/ruby/thread.bc /home/klee/ruby/version.bc /home/klee/ruby/strftime.bc /home/klee/ruby/memory_view.bc -o out.bc

rm /tmp/_ruby*

klee --posix-runtime --libc=klee --allocate-determ --allocate-determ-size=1000  --external-calls=all out.bc

klee --debug-print-instructions=all:file --posix-runtime --libc=klee --allocate-determ --allocate-determ-size=1000  --external-calls=all out.bc -- -e 'puts "hi" if ARGV[1] == "poop"'
